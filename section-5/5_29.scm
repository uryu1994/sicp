(load "./eceval")

(define (fib n)
  (if (< n 2)
      n
      (+ (fib (- n 1)) (fib (- n 2)))))

;; n = 2 -> p = 72  m = 13 fib = 1
;; n = 3 -> p = 128 m = 18 fib = 2
;; n = 4 -> p = 240 m = 23 fib = 3
;; n = 5 -> p = 408 m = 28 fib = 5

;; 5.29a
;; m = (n * 5) + 3 (n >= 2)

;; 5.29b
;; S(n) = S(n-1) + S(n-2) + k とすると
;; S(4) = S(3) + S(2) + k
;; 240 = 128 + 72 + k
;;
;; S(5) = S(4) + S(3) + k
;; 408 = 240 + 128 + k
;;...
;; k = 40

;; S(n) = a * Fib(n+1) + b
;; S(2) = a * 2 + b = 72
;; S(3) = a * 3 + b = 128
;; a = 56, b = -40
;;
;; よって
;; S(n) = S(n-1) + S(n-2) + 40
;; S(n) = 56 * Fib(n) - 40 + 56 * Fib(n-1) - 40 + 40
;; S(n) = 56 * (Fib(n) + Fib(n-1)) - 40
